# EasyKoa2 Blog

一个基于 Node.js 和 Koa2 框架开发的轻量级个人博客系统，具有高度可定制性和良好的性能表现。

## 功能特性

- **文章管理**：支持创建、编辑、发布、置顶文章，使用Markdown编辑器
- **分类管理**：支持多级分类结构，灵活组织文章
- **标签系统**：通过标签快速归类和查找相关文章
- **资源管理**：支持上传和管理图片等资源文件，支持JPG、PNG、GIF和SVG格式
- **SEO友好**：自动生成基于文章标题拼音的URL（如：/biao-ti-1.html）
- **页面缓存**：内置高效的页面缓存系统，带有缓存清理功能
- **响应式设计**：适配各种设备屏幕大小
- **管理后台**：功能完善的管理界面

## 技术栈

- **服务端**：Node.js, Koa2
- **数据库**：SQLite3
- **模板引擎**：art-template
- **Markdown处理**：marked
- **样式**：CSS3, Responsive design
- **缓存系统**：自定义文件缓存
- **拼音转换**：pinyin

## 快速开始

### 安装要求

- Node.js 12.0+
- npm 或 yarn

### 安装步骤

1. 克隆仓库到本地
   ```bash
   git clone https://github.com/tokyo-lei/easykoa2.git
   cd easykoa2
   ```

2. 安装依赖
   ```bash
   npm install
   # 或者使用 yarn
   yarn
   ```

3. 配置环境变量
   ```bash
   # 复制示例配置文件
   cp .env.example .env
   # 编辑配置文件，根据需要修改
   ```

4. 启动服务
   ```bash
   node app.js
   # 或使用nodemon进行开发
   npx nodemon app.js
   ```

5. 访问博客
   - 前台：http://localhost:3000
   - 后台：http://localhost:3000/admin (默认用户名：admin，密码：123456)

### 使用PM2部署（生产环境）

```bash
# 安装PM2
npm install -g pm2

# 启动应用
pm2 start app.js --name "blog-system"

# 设置开机自启
pm2 startup
pm2 save
```

## 目录结构

```
├── app/                      # 应用目录
│   ├── controllers/          # 控制器
│   ├── middleware/           # 中间件
│   ├── models/               # 数据模型
│   ├── public/               # 静态资源
│   ├── routes/               # 路由定义
│   ├── utils/                # 工具函数
│   └── views/                # 视图模板
├── config/                   # 配置文件
├── data/                     # 数据存储
│   ├── blog.db               # SQLite数据库
│   └── cache/                # 页面缓存
├── node_modules/             # 依赖包
├── .env                      # 环境变量
├── .gitignore                # Git忽略文件
├── app.js                    # 应用入口
├── package.json              # 项目配置
└── README.md                 # 项目说明
```

## 主要功能说明

### 文章管理

博客系统提供了完整的文章管理功能，包括创建、编辑、发布、置顶文章。文章内容支持Markdown格式，提供了基于Markdown的编辑器，方便编写富文本内容。

- **创建文章**：在管理后台点击"写文章"按钮
- **编辑文章**：在文章列表中点击"编辑"按钮
- **发布/草稿**：可以选择立即发布或保存为草稿
- **文章置顶**：重要文章可以设置置顶显示

### URL优化

系统会自动将文章标题转换为拼音，生成SEO友好的URL。例如，标题为"我的第一篇博客"的文章，其URL会被转换为"/wo-de-di-yi-pian-bo-ke-1.html"，其中数字是文章ID。

这种URL格式既方便用户阅读和记忆，也有利于搜索引擎收录。

### 缓存系统

为了提高网站性能，系统内置了高效的页面缓存功能：

- **缓存控制**：可在后台设置是否启用缓存、缓存时长
- **排除规则**：可设置特定页面不使用缓存
- **手动清理**：提供一键清除所有缓存的功能
- **调试信息**：开发模式下可查看页面缓存状态

### 资源管理

博客系统支持上传和管理图片等资源文件：

- **支持格式**：JPG、PNG、GIF和SVG
- **插入文章**：上传后可直接插入到文章中
- **资源复用**：已上传的资源可重复使用
- **替换功能**：支持替换已上传的资源

### 分类与标签

通过分类和标签系统，可以有效组织文章内容：

- **分类系统**：支持多级分类结构
- **标签功能**：可为文章添加多个标签
- **分类页**：可查看特定分类下的所有文章
- **标签页**：可查看包含特定标签的所有文章

## 系统设置

在管理后台的"设置"页面，可以配置博客的各项参数：

- **基本设置**：站点标题、描述、关键词等
- **显示设置**：每页文章数、日期格式等
- **缓存设置**：是否启用缓存、缓存时长、排除规则等
- **上传设置**：允许的文件类型、最大文件大小等

## 常见问题

### 如何修改管理员密码？

默认管理员账号为admin，密码为123456。在数据库中的`users`表中修改密码哈希值。

### 如何备份数据？

数据存储在`data/blog.db`SQLite数据库文件中，定期复制此文件即可完成备份。

### 如何自定义主题？

修改`app/public/static/css/blog.css`文件可以调整博客的样式和主题。

## 贡献指南

欢迎贡献代码、报告问题或提出建议。请遵循以下步骤：

1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/amazing-feature`)
3. 提交更改 (`git commit -m 'Add some amazing feature'`)
4. 推送到分支 (`git push origin feature/amazing-feature`)
5. 创建 Pull Request

## 许可证

本项目采用 MIT 许可证 - 详情请查看 [LICENSE](LICENSE) 文件
